<div class="calendar-component row m-0 px-2 zoom-{{ zoomLevel }}" [class.view-product-details]="zoomLevel >= 2">

    <!--  Calendar Header (Sticky) -->
    <div class="calendar-header sticky">
        <div class="calendar-header-seasons d-flex">
            <div class="calendar-header-season horizontal-sticky col" *ngFor="let item of seasons;">{{ item }}</div>  
        </div>
        <div class="calendar-header-months d-flex">
            <div class="calendar-header-month col"  *ngFor="let item of months; index as monthIdx"
                                                    [style.zIndex]="monthIdx"
            >
                {{ item }}
            </div>  
        </div>

        <div class="calendar-header-weeks d-flex">
            <div class="calendar-header-week week-size-col col p-0" *ngFor="let item of [].constructor(weeks); index as index"
                                                                    [style.min-width.px]="colSize"
            >
                {{ index+1 }}
            </div>
        </div>

        <div class="calendar-header-month-length d-flex">
            <month-length   *ngFor="let item of [].constructor(12); index as index" class="d-block"
                            [year]="year" 
                            [month]="index"
            >
            </month-length>
        </div>
    </div>


    <!--  Calendar Body -->
    <div class="calendar-body row d-flex flex-nowrap" [class.dragging]="dragging">

        <!--  Vertical header (Sticky) -->
        <div class="calendar-activities-header horizontal-sticky flex-with-gap">
            <div    [disableVar]="index > 0" *ngFor="let type of types; index as index" css-var="calendar-activities-header:get:width" class="calendar-activity-header vertical-sticky activity-type-{{type.code}}"
                    [style.min-height.px]="colSize * type.data?.colSize"
            >
                <span>{{ type.name }}</span>
            </div>
        </div>

        <!-- Activities per Week -->
        <div class="calendar-activity-group week-size-col col p-0"  *ngFor="let week of [].constructor(weeks); index as weekIdx"
                                                                    [style.min-width.px]="colSize"
        >
            <div class="calendar-placeholders flex-with-gap">
                <ng-container   *ngFor="let type of types; index as typeIdx">
                    <ng-container *ngIf="(activities!|findxv2:[{key:'startWeek',value:weekIdx+1},{key:'activityTypeId',value:type.id}]:true) as items">

                        <div    [class.empty]="items.length == 0" class="calendar-placeholder col-size-{{ type.data?.colSize }} activity-type-{{type.code}}"
                                [class.has-activity]="items.length"
                                [class.narrow]="type.data?.colSize < 5"
                                [attr.data-type-id]="type.id"
                                [attr.data-week]="weekIdx+1"
                                [style.min-height.px]="colSize * type.data?.colSize"
                        >
                        
                            <div class="calendar-activity-list">
                                <ng-container *ngIf="items?.length;">
                                    <commercial-calendar-activity   [activity]="item" class="calendar-activity" *ngFor="let item of items;"
                                                                    [isNarrow]="type.data?.colSize < 5"
                                                                    [style.width.px]="(item.endWeek - item.startWeek) * colSize - 4"
                                                                    [style.min-height.px]="type.data?.colSize == 1 && colSize * .85"
                                                                    [style.border-color]="item.color"
                                                                    [style.background-color]="item.fillColor"
                                                                    [class.custom-style]="item.fillColor?.length"
                                                                    [class.no-products]="!item.products?.length"
                                                                    (onClick)="activityClicked($event)"
                                                                    [colSize]="colSize"
                                    >
                                    </commercial-calendar-activity>
                                </ng-container>
                            </div>
                        </div>
                    </ng-container>
                </ng-container>
            </div>
        </div>

    </div>

    <!--  Zoom control -->
    <calendar-zoom  [level]="zoomLevel"
                    (onChange)="zoomChanged($event)"
    >
    </calendar-zoom>
</div>